var pmtiles=(()=>{var tt=Object.create;var ce=Object.defineProperty;var it=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var rt=Object.getPrototypeOf,st=Object.prototype.hasOwnProperty;var R=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ot=(e,t)=>{for(var i in t)ce(e,i,{get:t[i],enumerable:!0})},Be=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of nt(t))!st.call(e,s)&&s!==i&&ce(e,s,{get:()=>t[s],enumerable:!(n=it(t,s))||n.enumerable});return e};var V=(e,t,i)=>(i=e!=null?tt(rt(e)):{},Be(t||!e||!e.__esModule?ce(i,"default",{value:e,enumerable:!0}):i,e)),at=e=>Be(ce({},"__esModule",{value:!0}),e);var P=R((xi,Ce)=>{"use strict";Ce.exports=N;function N(e,t){this.x=e,this.y=t}N.prototype={clone:function(){return new N(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,i=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=i,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=t*this.x-i*this.y,s=i*this.x+t*this.y;return this.x=n,this.y=s,this},_rotateAround:function(e,t){var i=Math.cos(e),n=Math.sin(e),s=t.x+i*(this.x-t.x)-n*(this.y-t.y),r=t.y+n*(this.x-t.x)+i*(this.y-t.y);return this.x=s,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};N.convert=function(e){return e instanceof N?e:Array.isArray(e)?new N(e[0],e[1]):e}});var be=R((ki,Ve)=>{"use strict";var ft=P();Ve.exports=H;function H(e,t,i,n,s){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=s,e.readFields(ht,this,t)}function ht(e,t,i){e==1?t.id=i.readVarint():e==2?ut(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function ut(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var n=t._keys[e.readVarint()],s=t._values[e.readVarint()];t.properties[n]=s}}H.types=["Unknown","Point","LineString","Polygon"];H.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,n=0,s=0,r=0,o=[],f;e.pos<t;){if(n<=0){var h=e.readVarint();i=h&7,n=h>>3}if(n--,i===1||i===2)s+=e.readSVarint(),r+=e.readSVarint(),i===1&&(f&&o.push(f),f=[]),f.push(new ft(s,r));else if(i===7)f&&f.push(f[0].clone());else throw new Error("unknown command "+i)}return f&&o.push(f),o};H.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,n=0,s=0,r=0,o=1/0,f=-1/0,h=1/0,d=-1/0;e.pos<t;){if(n<=0){var g=e.readVarint();i=g&7,n=g>>3}if(n--,i===1||i===2)s+=e.readSVarint(),r+=e.readSVarint(),s<o&&(o=s),s>f&&(f=s),r<h&&(h=r),r>d&&(d=r);else if(i!==7)throw new Error("unknown command "+i)}return[o,h,f,d]};H.prototype.toGeoJSON=function(e,t,i){var n=this.extent*Math.pow(2,i),s=this.extent*e,r=this.extent*t,o=this.loadGeometry(),f=H.types[this.type],h,d;function g(M){for(var D=0;D<M.length;D++){var T=M[D],a=180-(T.y+r)*360/n;M[D]=[(T.x+s)*360/n-180,360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(h=0;h<o.length;h++)w[h]=o[h][0];o=w,g(o);break;case 2:for(h=0;h<o.length;h++)g(o[h]);break;case 3:for(o=dt(o),h=0;h<o.length;h++)for(d=0;d<o[h].length;d++)g(o[h][d]);break}o.length===1?o=o[0]:f="Multi"+f;var z={type:"Feature",geometry:{type:f,coordinates:o},properties:this.properties};return"id"in this&&(z.id=this.id),z};function dt(e){var t=e.length;if(t<=1)return[e];for(var i=[],n,s,r=0;r<t;r++){var o=mt(e[r]);o!==0&&(s===void 0&&(s=o<0),s===o<0?(n&&i.push(n),n=[e[r]]):n.push(e[r]))}return n&&i.push(n),i}function mt(e){for(var t=0,i=0,n=e.length,s=n-1,r,o;i<n;s=i++)r=e[i],o=e[s],t+=(o.x-r.x)*(r.y+o.y);return t}});var _e=R((zi,Ie)=>{"use strict";var pt=be();Ie.exports=Pe;function Pe(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(yt,this,t),this.length=this._features.length}function yt(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(gt(i))}function gt(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}Pe.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new pt(this._pbf,t,this.extent,this._keys,this._values)}});var Re=R((Mi,Ae)=>{"use strict";var xt=_e();Ae.exports=wt;function wt(e,t){this.layers=e.readFields(bt,{},t)}function bt(e,t,i){if(e===3){var n=new xt(i,i.readVarint()+i.pos);n.length&&(t[n.name]=n)}}});var Ue=R((Fi,he)=>{he.exports.VectorTile=Re();he.exports.VectorTileFeature=be();he.exports.VectorTileLayer=_e()});var Ee=R(ve=>{ve.read=function(e,t,i,n,s){var r,o,f=s*8-n-1,h=(1<<f)-1,d=h>>1,g=-7,w=i?s-1:0,z=i?-1:1,M=e[t+w];for(w+=z,r=M&(1<<-g)-1,M>>=-g,g+=f;g>0;r=r*256+e[t+w],w+=z,g-=8);for(o=r&(1<<-g)-1,r>>=-g,g+=n;g>0;o=o*256+e[t+w],w+=z,g-=8);if(r===0)r=1-d;else{if(r===h)return o?NaN:(M?-1:1)*(1/0);o=o+Math.pow(2,n),r=r-d}return(M?-1:1)*o*Math.pow(2,r-n)};ve.write=function(e,t,i,n,s,r){var o,f,h,d=r*8-s-1,g=(1<<d)-1,w=g>>1,z=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=n?0:r-1,D=n?1:-1,T=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(f=isNaN(t)?1:0,o=g):(o=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-o))<1&&(o--,h*=2),o+w>=1?t+=z/h:t+=z*Math.pow(2,1-w),t*h>=2&&(o++,h/=2),o+w>=g?(f=0,o=g):o+w>=1?(f=(t*h-1)*Math.pow(2,s),o=o+w):(f=t*Math.pow(2,w-1)*Math.pow(2,s),o=0));s>=8;e[i+M]=f&255,M+=D,f/=256,s-=8);for(o=o<<s|f,d+=s;d>0;e[i+M]=o&255,M+=D,o/=256,d-=8);e[i+M-D]|=T*128}});var We=R((Li,He)=>{"use strict";He.exports=v;var ue=Ee();function v(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}v.Varint=0;v.Fixed64=1;v.Bytes=2;v.Fixed32=5;var ke=(1<<16)*(1<<16),je=1/ke,_t=12,Ne=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");v.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),s=n>>3,r=this.pos;this.type=n&7,e(s,t,this),this.pos===r&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=de(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Oe(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=de(this.buf,this.pos)+de(this.buf,this.pos+4)*ke;return this.pos+=8,e},readSFixed64:function(){var e=de(this.buf,this.pos)+Oe(this.buf,this.pos+4)*ke;return this.pos+=8,e},readFloat:function(){var e=ue.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ue.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,i,n;return n=t[this.pos++],i=n&127,n<128||(n=t[this.pos++],i|=(n&127)<<7,n<128)||(n=t[this.pos++],i|=(n&127)<<14,n<128)||(n=t[this.pos++],i|=(n&127)<<21,n<128)?i:(n=t[this.pos],i|=(n&15)<<28,vt(i,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=_t&&Ne?Pt(this.buf,t,e):Vt(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==v.Bytes)return e.push(this.readVarint(t));var i=I(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==v.Bytes)return e.push(this.readSVarint());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==v.Bytes)return e.push(this.readBoolean());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==v.Bytes)return e.push(this.readFloat());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==v.Bytes)return e.push(this.readDouble());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==v.Bytes)return e.push(this.readFixed32());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==v.Bytes)return e.push(this.readSFixed32());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==v.Bytes)return e.push(this.readFixed64());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==v.Bytes)return e.push(this.readSFixed64());var t=I(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===v.Varint)for(;this.buf[this.pos++]>127;);else if(t===v.Bytes)this.pos=this.readVarint()+this.pos;else if(t===v.Fixed32)this.pos+=4;else if(t===v.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),K(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),K(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),K(this.buf,e&-1,this.pos),K(this.buf,Math.floor(e*je),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),K(this.buf,e&-1,this.pos),K(this.buf,Math.floor(e*je),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){kt(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=It(this.buf,e,this.pos);var i=this.pos-t;i>=128&&$e(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),ue.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ue.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var n=this.pos-i;n>=128&&$e(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,i){this.writeTag(e,v.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Ft,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Dt,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,St,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Lt,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Tt,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Bt,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Ct,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Xt,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Yt,t)},writeBytesField:function(e,t){this.writeTag(e,v.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,v.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,v.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,v.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,v.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,v.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,v.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,v.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,v.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,v.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function vt(e,t,i){var n=i.buf,s,r;if(r=n[i.pos++],s=(r&112)>>4,r<128||(r=n[i.pos++],s|=(r&127)<<3,r<128)||(r=n[i.pos++],s|=(r&127)<<10,r<128)||(r=n[i.pos++],s|=(r&127)<<17,r<128)||(r=n[i.pos++],s|=(r&127)<<24,r<128)||(r=n[i.pos++],s|=(r&1)<<31,r<128))return W(e,s,t);throw new Error("Expected varint not more than 10 bytes")}function I(e){return e.type===v.Bytes?e.readVarint()+e.pos:e.pos+1}function W(e,t,i){return i?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function kt(e,t){var i,n;if(e>=0?(i=e%4294967296|0,n=e/4294967296|0):(i=~(-e%4294967296),n=~(-e/4294967296),i^4294967295?i=i+1|0:(i=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),zt(i,n,t),Mt(n,t)}function zt(e,t,i){i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos]=e&127}function Mt(e,t){var i=(e&7)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function $e(e,t,i){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));i.realloc(n);for(var s=i.pos-1;s>=e;s--)i.buf[s+n]=i.buf[s]}function Ft(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Dt(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Lt(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Tt(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function St(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function Bt(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Ct(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Xt(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Yt(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function de(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function K(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function Oe(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Vt(e,t,i){for(var n="",s=t;s<i;){var r=e[s],o=null,f=r>239?4:r>223?3:r>191?2:1;if(s+f>i)break;var h,d,g;f===1?r<128&&(o=r):f===2?(h=e[s+1],(h&192)===128&&(o=(r&31)<<6|h&63,o<=127&&(o=null))):f===3?(h=e[s+1],d=e[s+2],(h&192)===128&&(d&192)===128&&(o=(r&15)<<12|(h&63)<<6|d&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):f===4&&(h=e[s+1],d=e[s+2],g=e[s+3],(h&192)===128&&(d&192)===128&&(g&192)===128&&(o=(r&15)<<18|(h&63)<<12|(d&63)<<6|g&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,f=1):o>65535&&(o-=65536,n+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),n+=String.fromCharCode(o),s+=f}return n}function Pt(e,t,i){return Ne.decode(e.subarray(t,i))}function It(e,t,i){for(var n=0,s,r;n<t.length;n++){if(s=t.charCodeAt(n),s>55295&&s<57344)if(r)if(s<56320){e[i++]=239,e[i++]=191,e[i++]=189,r=s;continue}else s=r-55296<<10|s-56320|65536,r=null;else{s>56319||n+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):r=s;continue}else r&&(e[i++]=239,e[i++]=191,e[i++]=189,r=null);s<128?e[i++]=s:(s<2048?e[i++]=s>>6|192:(s<65536?e[i++]=s>>12|224:(e[i++]=s>>18|240,e[i++]=s>>12&63|128),e[i++]=s>>6&63|128),e[i++]=s&63|128)}return i}});var Qe=R((De,Le)=>{(function(e,t){typeof De=="object"&&typeof Le!="undefined"?Le.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self).RBush=t()})(De,function(){"use strict";function e(a,l,c,m,p){(function u(y,x,b,_,S){for(;_>b;){if(_-b>600){var F=_-b+1,C=x-b+1,J=Math.log(F),E=.5*Math.exp(2*J/3),$=.5*Math.sqrt(J*E*(F-E)/F)*(C-F/2<0?-1:1),O=Math.max(b,Math.floor(x-C*E/F+$)),et=Math.min(_,Math.floor(x+(F-C)*E/F+$));u(y,x,O,et,S)}var le=y[x],Q=b,Y=_;for(t(y,b,x),S(y[_],le)>0&&t(y,b,_);Q<Y;){for(t(y,Q,Y),Q++,Y--;S(y[Q],le)<0;)Q++;for(;S(y[Y],le)>0;)Y--}S(y[b],le)===0?t(y,b,Y):t(y,++Y,_),Y<=x&&(b=Y+1),x<=Y&&(_=Y-1)}})(a,l,c||0,m||a.length-1,p||i)}function t(a,l,c){var m=a[l];a[l]=a[c],a[c]=m}function i(a,l){return a<l?-1:a>l?1:0}var n=function(a){a===void 0&&(a=9),this._maxEntries=Math.max(4,a),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(a,l,c){if(!c)return l.indexOf(a);for(var m=0;m<l.length;m++)if(c(a,l[m]))return m;return-1}function r(a,l){o(a,0,a.children.length,l,a)}function o(a,l,c,m,p){p||(p=D(null)),p.minX=1/0,p.minY=1/0,p.maxX=-1/0,p.maxY=-1/0;for(var u=l;u<c;u++){var y=a.children[u];f(p,a.leaf?m(y):y)}return p}function f(a,l){return a.minX=Math.min(a.minX,l.minX),a.minY=Math.min(a.minY,l.minY),a.maxX=Math.max(a.maxX,l.maxX),a.maxY=Math.max(a.maxY,l.maxY),a}function h(a,l){return a.minX-l.minX}function d(a,l){return a.minY-l.minY}function g(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function w(a){return a.maxX-a.minX+(a.maxY-a.minY)}function z(a,l){return a.minX<=l.minX&&a.minY<=l.minY&&l.maxX<=a.maxX&&l.maxY<=a.maxY}function M(a,l){return l.minX<=a.maxX&&l.minY<=a.maxY&&l.maxX>=a.minX&&l.maxY>=a.minY}function D(a){return{children:a,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(a,l,c,m,p){for(var u=[l,c];u.length;)if(!((c=u.pop())-(l=u.pop())<=m)){var y=l+Math.ceil((c-l)/m/2)*m;e(a,y,l,c,p),u.push(l,y,y,c)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(a){var l=this.data,c=[];if(!M(a,l))return c;for(var m=this.toBBox,p=[];l;){for(var u=0;u<l.children.length;u++){var y=l.children[u],x=l.leaf?m(y):y;M(a,x)&&(l.leaf?c.push(y):z(a,x)?this._all(y,c):p.push(y))}l=p.pop()}return c},n.prototype.collides=function(a){var l=this.data;if(!M(a,l))return!1;for(var c=[];l;){for(var m=0;m<l.children.length;m++){var p=l.children[m],u=l.leaf?this.toBBox(p):p;if(M(a,u)){if(l.leaf||z(a,u))return!0;c.push(p)}}l=c.pop()}return!1},n.prototype.load=function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var l=0;l<a.length;l++)this.insert(a[l]);return this}var c=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===c.height)this._splitRoot(this.data,c);else{if(this.data.height<c.height){var m=this.data;this.data=c,c=m}this._insert(c,this.data.height-c.height-1,!0)}else this.data=c;return this},n.prototype.insert=function(a){return a&&this._insert(a,this.data.height-1),this},n.prototype.clear=function(){return this.data=D([]),this},n.prototype.remove=function(a,l){if(!a)return this;for(var c,m,p,u=this.data,y=this.toBBox(a),x=[],b=[];u||x.length;){if(u||(u=x.pop(),m=x[x.length-1],c=b.pop(),p=!0),u.leaf){var _=s(a,u.children,l);if(_!==-1)return u.children.splice(_,1),x.push(u),this._condense(x),this}p||u.leaf||!z(u,y)?m?(c++,u=m.children[c],p=!1):u=null:(x.push(u),b.push(c),c=0,m=u,u=u.children[0])}return this},n.prototype.toBBox=function(a){return a},n.prototype.compareMinX=function(a,l){return a.minX-l.minX},n.prototype.compareMinY=function(a,l){return a.minY-l.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(a){return this.data=a,this},n.prototype._all=function(a,l){for(var c=[];a;)a.leaf?l.push.apply(l,a.children):c.push.apply(c,a.children),a=c.pop();return l},n.prototype._build=function(a,l,c,m){var p,u=c-l+1,y=this._maxEntries;if(u<=y)return r(p=D(a.slice(l,c+1)),this.toBBox),p;m||(m=Math.ceil(Math.log(u)/Math.log(y)),y=Math.ceil(u/Math.pow(y,m-1))),(p=D([])).leaf=!1,p.height=m;var x=Math.ceil(u/y),b=x*Math.ceil(Math.sqrt(y));T(a,l,c,b,this.compareMinX);for(var _=l;_<=c;_+=b){var S=Math.min(_+b-1,c);T(a,_,S,x,this.compareMinY);for(var F=_;F<=S;F+=x){var C=Math.min(F+x-1,S);p.children.push(this._build(a,F,C,m-1))}}return r(p,this.toBBox),p},n.prototype._chooseSubtree=function(a,l,c,m){for(;m.push(l),!l.leaf&&m.length-1!==c;){for(var p=1/0,u=1/0,y=void 0,x=0;x<l.children.length;x++){var b=l.children[x],_=g(b),S=(F=a,C=b,(Math.max(C.maxX,F.maxX)-Math.min(C.minX,F.minX))*(Math.max(C.maxY,F.maxY)-Math.min(C.minY,F.minY))-_);S<u?(u=S,p=_<p?_:p,y=b):S===u&&_<p&&(p=_,y=b)}l=y||l.children[0]}var F,C;return l},n.prototype._insert=function(a,l,c){var m=c?a:this.toBBox(a),p=[],u=this._chooseSubtree(m,this.data,l,p);for(u.children.push(a),f(u,m);l>=0&&p[l].children.length>this._maxEntries;)this._split(p,l),l--;this._adjustParentBBoxes(m,p,l)},n.prototype._split=function(a,l){var c=a[l],m=c.children.length,p=this._minEntries;this._chooseSplitAxis(c,p,m);var u=this._chooseSplitIndex(c,p,m),y=D(c.children.splice(u,c.children.length-u));y.height=c.height,y.leaf=c.leaf,r(c,this.toBBox),r(y,this.toBBox),l?a[l-1].children.push(y):this._splitRoot(c,y)},n.prototype._splitRoot=function(a,l){this.data=D([a,l]),this.data.height=a.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(a,l,c){for(var m,p,u,y,x,b,_,S=1/0,F=1/0,C=l;C<=c-l;C++){var J=o(a,0,C,this.toBBox),E=o(a,C,c,this.toBBox),$=(p=J,u=E,y=void 0,x=void 0,b=void 0,_=void 0,y=Math.max(p.minX,u.minX),x=Math.max(p.minY,u.minY),b=Math.min(p.maxX,u.maxX),_=Math.min(p.maxY,u.maxY),Math.max(0,b-y)*Math.max(0,_-x)),O=g(J)+g(E);$<S?(S=$,m=C,F=O<F?O:F):$===S&&O<F&&(F=O,m=C)}return m||c-l},n.prototype._chooseSplitAxis=function(a,l,c){var m=a.leaf?this.compareMinX:h,p=a.leaf?this.compareMinY:d;this._allDistMargin(a,l,c,m)<this._allDistMargin(a,l,c,p)&&a.children.sort(m)},n.prototype._allDistMargin=function(a,l,c,m){a.children.sort(m);for(var p=this.toBBox,u=o(a,0,l,p),y=o(a,c-l,c,p),x=w(u)+w(y),b=l;b<c-l;b++){var _=a.children[b];f(u,a.leaf?p(_):_),x+=w(u)}for(var S=c-l-1;S>=l;S--){var F=a.children[S];f(y,a.leaf?p(F):F),x+=w(y)}return x},n.prototype._adjustParentBBoxes=function(a,l,c){for(var m=c;m>=0;m--)f(l[m],a)},n.prototype._condense=function(a){for(var l=a.length-1,c=void 0;l>=0;l--)a[l].children.length===0?l>0?(c=a[l-1].children).splice(c.indexOf(a[l]),1):this.clear():r(a[l],this.toBBox)},n})});var yi={};ot(yi,{filterFn:()=>ae,getFont:()=>Se,mapbox_style:()=>pi,numberFn:()=>ge,numberOrFn:()=>U,widthFn:()=>Te});var hi=V(P(),1);var ne=V(P(),1);var X=class{constructor(t,i){this.str=t!=null?t:i,this.perFeature=typeof this.str=="function"&&this.str.length===2}get(t,i){return typeof this.str=="function"?this.str(t,i):this.str}},B=class{constructor(t,i=1){this.value=t!=null?t:i,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(t,i){return typeof this.value=="function"?this.value(t,i):this.value}},ee=class{constructor(t){var i;this.labelProps=(i=t==null?void 0:t.labelProps)!==null&&i!==void 0?i:["name"],this.textTransform=t==null?void 0:t.textTransform}get(t,i){let n,s;typeof this.labelProps=="function"?s=this.labelProps(t,i):s=this.labelProps;for(let o of s)if(Object.prototype.hasOwnProperty.call(i.props,o)&&typeof i.props[o]=="string"){n=i.props[o];break}let r;return typeof this.textTransform=="function"?r=this.textTransform(t,i):r=this.textTransform,n&&r==="uppercase"?n=n.toUpperCase():n&&r==="lowercase"?n=n.toLowerCase():n&&r==="capitalize"&&(n=n.toLowerCase().split(" ").map(h=>h[0].toUpperCase()+h.slice(1)).join(" ")),n}},te=class{constructor(t){var i,n;t!=null&&t.font?this.font=t.font:(this.family=(i=t==null?void 0:t.fontFamily)!==null&&i!==void 0?i:"sans-serif",this.size=(n=t==null?void 0:t.fontSize)!==null&&n!==void 0?n:12,this.weight=t==null?void 0:t.fontWeight,this.style=t==null?void 0:t.fontStyle)}get(t,i){if(this.font)return typeof this.font=="function"?this.font(t,i):this.font;let n="";this.style&&(typeof this.style=="function"?n=`${this.style(t,i)} `:n=`${this.style} `);let s="";this.weight&&(typeof this.weight=="function"?s=`${this.weight(t,i)} `:s=`${this.weight} `);let r;typeof this.size=="function"?r=this.size(t,i):r=this.size;let o;return typeof this.family=="function"?o=this.family(t,i):o=this.family,`${n}${s}${r}px ${o}`}},fe=class{constructor(t,i=[]){this.value=t!=null?t:i,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(t,i){return typeof this.value=="function"?this.value(t,i):this.value}};var xe=V(P(),1),lt=(e,t,i)=>{let n=[],s,r,o,f=0,h=0,d=0,g=0,w=0,z=0,M=0,D=0,T=0,a=0,l=0,c=0;if(e.length<2)return[];if(e.length===2)return d=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),[{length:d,beginIndex:0,beginDistance:0,endIndex:2,endDistance:d}];for(g=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),f=1,h=e.length-1;f<h;f++)s=e[f-1],r=e[f],o=e[f+1],z=r.x-s.x,M=r.y-s.y,D=o.x-r.x,T=o.y-r.y,w=Math.sqrt(D*D+T*T),d+=g,a=Math.acos((z*D+M*T)/(g*w)),(a>t||d-c>i)&&(n.push({length:d-c,beginDistance:c,beginIndex:l,endIndex:f+1,endDistance:d}),l=f,c=d),g=w;return f-l>0&&n.push({length:d-c+w,beginIndex:l,beginDistance:c,endIndex:f+1,endDistance:d+w}),n};function Xe(e,t,i,n){let s=[];for(let r of e){let o=lt(r,Math.PI/45,t);for(let f of o)if(f.length>=t+n){let h=new xe.default(r[f.beginIndex].x,r[f.beginIndex].y),d=r[f.endIndex-1],g=new xe.default((d.x-h.x)/f.length,(d.y-h.y)/f.length);for(let w=n;w<f.length-t;w+=i)s.push({start:h.add(g.mult(w)),end:h.add(g.mult(w+t))})}}return s}function Ye(e,t,i,n){let s=t.x-e.x,r=t.y-e.y,o=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),f=[];for(let h=0;h<i+n;h+=2*n){let d=h*1/o;f.push({x:e.x+d*s,y:e.y+d*r})}return f}function we(e,t){if(e.length<=t)return[e];let i=t-1,n=e.lastIndexOf(" ",i),s=e.indexOf(" ",i);if(n===-1&&s===-1)return[e];let r,o;return s===-1||n>=0&&i-n<s-i?(r=e.substring(0,n),o=e.substring(n+1,e.length)):(r=e.substring(0,s),o=e.substring(s+1,e.length)),[r,...we(o,t)]}var ct="\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DB5\u4E00-\u9FEA\uF900-\uFA6D\uFA70-\uFAD9\u2000",_i=new RegExp(`^[${ct}]+$`);var Kt=V(P(),1),qt=V(Ue(),1),Zt=V(We(),1);var q=Uint8Array,Ke=Uint16Array,At=Int32Array,Rt=new q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ut=new q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ti=new q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qe=function(e,t){for(var i=new Ke(31),n=0;n<31;++n)i[n]=t+=1<<e[n-1];for(var s=new At(i[30]),n=1;n<30;++n)for(var r=i[n];r<i[n+1];++r)s[r]=r-i[n]<<5|n;return{b:i,r:s}},Ze=qe(Rt,2),Et=Ze.b,jt=Ze.r;Et[28]=258,jt[258]=28;var Ge=qe(Ut,0),Si=Ge.b,Bi=Ge.r,$t=new Ke(32768);for(k=0;k<32768;++k)A=(k&43690)>>1|(k&21845)<<1,A=(A&52428)>>2|(A&13107)<<2,A=(A&61680)>>4|(A&3855)<<4,$t[k]=((A&65280)>>8|(A&255)<<8)>>1;var A,k;var me=new q(288);for(k=0;k<144;++k)me[k]=8;var k;for(k=144;k<256;++k)me[k]=9;var k;for(k=256;k<280;++k)me[k]=7;var k;for(k=280;k<288;++k)me[k]=8;var k,Ot=new q(32);for(k=0;k<32;++k)Ot[k]=5;var k;var Nt=new q(0);var Ht=typeof TextDecoder!="undefined"&&new TextDecoder,Wt=0;try{Ht.decode(Nt,{stream:!0}),Wt=1}catch(e){}var ze;(function(e){e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.Polygon=3]="Polygon"})(ze||(ze={}));var Gt=6378137;var Vi=Gt*Math.PI;var j;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(j||(j={}));var Je;(function(e){e[e.N=1]="N",e[e.Ne=2]="Ne",e[e.E=3]="E",e[e.Se=4]="Se",e[e.S=5]="S",e[e.Sw=6]="Sw",e[e.W=7]="W",e[e.Nw=8]="Nw"})(Je||(Je={}));var Z=class{constructor(t){var i;this.pattern=t.pattern,this.fill=new X(t.fill,"black"),this.opacity=new B(t.opacity,1),this.stroke=new X(t.stroke,"black"),this.width=new B(t.width,0),this.perFeature=(i=this.fill.perFeature||this.opacity.perFeature||this.stroke.perFeature||this.width.perFeature||t.perFeature)!==null&&i!==void 0?i:!1,this.doStroke=!1}before(t,i){if(!this.perFeature){t.globalAlpha=this.opacity.get(i),t.fillStyle=this.fill.get(i),t.strokeStyle=this.stroke.get(i);let n=this.width.get(i);n>0&&(this.doStroke=!0),t.lineWidth=n}if(this.pattern){let n=t.createPattern(this.pattern,"repeat");n&&(t.fillStyle=n)}}draw(t,i,n,s){let r=!1;if(this.perFeature){t.globalAlpha=this.opacity.get(n,s),t.fillStyle=this.fill.get(n,s);let f=this.width.get(n,s);f&&(r=!0,t.strokeStyle=this.stroke.get(n,s),t.lineWidth=f)}let o=()=>{t.fill(),(r||this.doStroke)&&t.stroke()};t.beginPath();for(let f of i)for(let h=0;h<f.length;h++){let d=f[h];h===0?t.moveTo(d.x,d.y):t.lineTo(d.x,d.y)}o()}};function Jt(e,t){let i=0;for(;t[i+1][0]<e;)i++;return i}function Qt(e,t,i){return e*(i-t)+t}function ei(e,t,i,n){let s=n[t+1][0]-n[t][0],r=e-n[t][0];return s===0?0:i===1?r/s:(Math.pow(i,r)-1)/(Math.pow(i,s)-1)}function pe(e,t){return i=>{if(t.length<1)return 0;if(i<=t[0][0])return t[0][1];if(i>=t[t.length-1][0])return t[t.length-1][1];let n=Jt(i,t),s=ei(i,n,e,t);return Qt(s,t[n][1],t[n+1][1])}}var G=class{constructor(t){var i;this.color=new X(t.color,"black"),this.width=new B(t.width),this.opacity=new B(t.opacity),this.dash=t.dash?new fe(t.dash):null,this.dashColor=new X(t.dashColor,"black"),this.dashWidth=new B(t.dashWidth,1),this.lineCap=new X(t.lineCap,"butt"),this.lineJoin=new X(t.lineJoin,"miter"),this.skip=!1,this.perFeature=!!(((i=this.dash)===null||i===void 0?void 0:i.perFeature)||this.color.perFeature||this.opacity.perFeature||this.width.perFeature||this.lineCap.perFeature||this.lineJoin.perFeature||t.perFeature)}before(t,i){this.perFeature||(t.strokeStyle=this.color.get(i),t.lineWidth=this.width.get(i),t.globalAlpha=this.opacity.get(i),t.lineCap=this.lineCap.get(i),t.lineJoin=this.lineJoin.get(i))}draw(t,i,n,s){if(this.skip)return;let r=()=>{this.perFeature&&(t.globalAlpha=this.opacity.get(n,s),t.lineCap=this.lineCap.get(n,s),t.lineJoin=this.lineJoin.get(n,s)),this.dash?(t.save(),this.perFeature?(t.lineWidth=this.dashWidth.get(n,s),t.strokeStyle=this.dashColor.get(n,s),t.setLineDash(this.dash.get(n,s))):t.setLineDash(this.dash.get(n)),t.stroke(),t.restore()):(t.save(),this.perFeature&&(t.lineWidth=this.width.get(n,s),t.strokeStyle=this.color.get(n,s)),t.stroke(),t.restore())};t.beginPath();for(let o of i)for(let f=0;f<o.length;f++){let h=o[f];f===0?t.moveTo(h.x,h.y):t.lineTo(h.x,h.y)}r()}};var re=class{constructor(t){this.radius=new B(t.radius,3),this.fill=new X(t.fill,"black"),this.stroke=new X(t.stroke,"white"),this.width=new B(t.width,0),this.opacity=new B(t.opacity)}draw(t,i,n,s){t.globalAlpha=this.opacity.get(n,s);let r=this.radius.get(n,s),o=this.width.get(n,s);o>0&&(t.strokeStyle=this.stroke.get(n,s),t.lineWidth=o,t.beginPath(),t.arc(i[0][0].x,i[0][0].y,r+o/2,0,2*Math.PI),t.stroke()),t.fillStyle=this.fill.get(n,s),t.beginPath(),t.arc(i[0][0].x,i[0][0].y,r,0,2*Math.PI),t.fill()}place(t,i,n){let s=i[0],r=new ne.default(i[0][0].x,i[0][0].y),o=this.radius.get(t.zoom,n),f={minX:r.x-o,minY:r.y-o,maxX:r.x+o,maxY:r.y+o};return[{anchor:r,bboxes:[f],draw:d=>{this.draw(d,[[new ne.default(0,0)]],t.zoom,n)}}]}};var Me=class{constructor(t){this.symbolizer=t}place(t,i,n){let s=i[0][0],r=this.symbolizer.place(t,[[new ne.default(0,0)]],n);if(!r||r.length===0)return;let o=r[0],f=o.bboxes[0],h=f.maxX-f.minX,d=f.maxY-f.minY,g={minX:s.x-h/2,maxX:s.x+h/2,minY:s.y-d/2,maxY:s.y+d/2};return[{anchor:s,bboxes:[g],draw:z=>{z.translate(-h/2,d/2-f.maxY),o.draw(z,{justify:j.Center})}}]}};var Fe=class{constructor(t){this.font=new te(t),this.text=new ee(t),this.fill=new X(t.fill,"black"),this.stroke=new X(t.stroke,"black"),this.width=new B(t.width,0),this.lineHeight=new B(t.lineHeight,1),this.letterSpacing=new B(t.letterSpacing,0),this.maxLineCodeUnits=new B(t.maxLineChars,15),this.justify=t.justify}place(t,i,n){let s=this.text.get(t.zoom,n);if(!s)return;let r=this.font.get(t.zoom,n);t.scratch.font=r;let o=this.letterSpacing.get(t.zoom,n),f=we(s,this.maxLineCodeUnits.get(t.zoom,n)),h="",d=0;for(let c of f)c.length>d&&(d=c.length,h=c);let g=t.scratch.measureText(h),w=g.width+o*(d-1),z=g.actualBoundingBoxAscent,M=g.actualBoundingBoxDescent,D=(z+M)*this.lineHeight.get(t.zoom,n),T=new ne.default(i[0][0].x,i[0][0].y),a={minX:T.x,minY:T.y-z,maxX:T.x+w,maxY:T.y+M+(f.length-1)*D};return[{anchor:T,bboxes:[a],draw:(c,m)=>{c.globalAlpha=1,c.font=r,c.fillStyle=this.fill.get(t.zoom,n);let p=this.width.get(t.zoom,n),u=0;for(let y of f){let x=0;if(this.justify===j.Center||m&&m.justify===j.Center?x=(w-c.measureText(y).width)/2:(this.justify===j.Right||m&&m.justify===j.Right)&&(x=w-c.measureText(y).width),p)if(c.lineWidth=p*2,c.strokeStyle=this.stroke.get(t.zoom,n),o>0){let b=x;for(let _ of y)c.strokeText(_,b,u),b+=c.measureText(_).width+o}else c.strokeText(y,x,u);if(o>0){let b=x;for(let _ of y)c.fillText(_,b,u),b+=c.measureText(_).width+o}else c.fillText(y,x,u);u+=D}}}]}},se=class{constructor(t){this.centered=new Me(new Fe(t))}place(t,i,n){return this.centered.place(t,i,n)}};var ie;(function(e){e[e.Above=1]="Above",e[e.Center=2]="Center",e[e.Below=3]="Below"})(ie||(ie={}));var oe=class{constructor(t){var i;this.font=new te(t),this.text=new ee(t),this.fill=new X(t.fill,"black"),this.stroke=new X(t.stroke,"black"),this.width=new B(t.width,0),this.offset=new B(t.offset,0),this.position=(i=t.position)!==null&&i!==void 0?i:ie.Above,this.maxLabelCodeUnits=new B(t.maxLabelChars,40),this.repeatDistance=new B(t.repeatDistance,250)}place(t,i,n){let s=this.text.get(t.zoom,n);if(!s||s.length>this.maxLabelCodeUnits.get(t.zoom,n))return;let r=20,o=n.bbox;if(o.maxY-o.minY<r&&o.maxX-o.minX<r)return;let f=this.font.get(t.zoom,n);t.scratch.font=f;let h=t.scratch.measureText(s),d=h.width,g=h.actualBoundingBoxAscent+h.actualBoundingBoxDescent,w=this.repeatDistance.get(t.zoom,n);t.overzoom>4&&(w*=1<<t.overzoom-4);let z=g*2,M=Xe(i,d,w,z);if(M.length===0)return;let D=[];for(let T of M){let a=T.end.x-T.start.x,l=T.end.y-T.start.y,m=Ye(T.start,T.end,d,z/2).map(u=>({minX:u.x-z/2,minY:u.y-z/2,maxX:u.x+z/2,maxY:u.y+z/2})),p=u=>{u.globalAlpha=1,u.rotate(Math.atan2(l,a)),a<0&&(u.scale(-1,-1),u.translate(-d,0));let y=0;this.position===ie.Below?y+=g:this.position===ie.Center&&(y+=g/2),u.translate(0,y-this.offset.get(t.zoom,n)),u.font=f;let x=this.width.get(t.zoom,n);x&&(u.lineWidth=x,u.strokeStyle=this.stroke.get(t.zoom,n),u.strokeText(s,0,0)),u.fillStyle=this.fill.get(t.zoom,n),u.fillText(s,0,0)};D.push({anchor:T.start,bboxes:m,draw:p,deduplicationKey:s,deduplicationDistance:w})}return D}};var ni=V(P(),1),ri=V(Qe(),1);var ti=V(P(),1);var si=V(P(),1);var ui=6378137;var un=ui*Math.PI;var di=V(P(),1);function ye(e,t){return typeof e=="number"?e:t}function mi(e){return e.geomType===1?"Point":e.geomType===2?"LineString":"Polygon"}function ae(e){if(e.includes("$type")&&e[0]==="==")return(t,i)=>mi(i)===e[2];if(e[0]==="==")return(t,i)=>i.props[e[1]]===e[2];if(e[0]==="!=")return(t,i)=>i.props[e[1]]!==e[2];if(e[0]==="!"){let t=ae(e[1]);return(i,n)=>!t(i,n)}if(e[0]==="<")return(t,i)=>ye(i.props[e[1]],1/0)<e[2];if(e[0]==="<=")return(t,i)=>ye(i.props[e[1]],1/0)<=e[2];if(e[0]===">")return(t,i)=>ye(i.props[e[1]],-1/0)>e[2];if(e[0]===">=")return(t,i)=>ye(i.props[e[1]],-1/0)>=e[2];if(e[0]==="in")return(t,i)=>e.slice(2,e.length).includes(i.props[e[1]]);if(e[0]==="!in")return(t,i)=>!e.slice(2,e.length).includes(i.props[e[1]]);if(e[0]==="has")return(t,i)=>i.props.hasOwnProperty(e[1]);if(e[0]==="!has")return(t,i)=>!i.props.hasOwnProperty(e[1]);if(e[0]==="all"){let t=e.slice(1,e.length).map(i=>ae(i));return(i,n)=>t.every(s=>s(i,n))}if(e[0]==="any"){let t=e.slice(1,e.length).map(i=>ae(i));return(i,n)=>t.some(s=>s(i,n))}return console.log("Unimplemented filter: ",e[0]),t=>!1}function ge(e){if(e.stops)return t=>pe(e.base||1,e.stops)(t-1);if(e[0]==="interpolate"&&e[1][0]==="exponential"&&e[2][0]==="zoom"){let t=e.slice(3),i=[];for(let n=0;n<t.length;n+=2)i.push([t[n],t[n+1]]);return n=>pe(e[1][1],i)(n-1)}if(e[0]==="step"&&e[1][0]==="get"){let t=e.slice(2),i=e[1][1];return(n,s)=>{let r=s==null?void 0:s.props[i];if(typeof r=="number"){if(r<t[1])return t[0];for(let o=1;o<t.length;o+=2)if(r<=t[o])return t[o+1]}return t[t.length-1]}}return console.log("Unimplemented numeric fn: ",e),t=>1}function U(e,t=0){return e?typeof e=="number"?e:(i,n)=>n?ge(e)(i,n):t:t}function Te(e,t){let i=U(e,1),n=U(t);return(s,r)=>{let o=typeof i=="number"?i:i(s,r);return n?o+(typeof n=="number"?n:n(s,r)):o}}function Se(e,t){let i=[];for(let o of e["text-font"])t.hasOwnProperty(o)&&i.push(t[o]);i.length===0&&i.push({face:"sans-serif"});let n=e["text-size"],s="";i.length&&i[0].weight&&(s=`${i[0].weight} `);let r="";if(i.length&&i[0].style&&(r=`${i[0].style} `),typeof n=="number")return o=>`${r}${s}${n}px ${i.map(f=>f.face).join(", ")}`;if(n.stops){let o=1.4;n.base?o=n.base:n.base=o;let f=ge(n);return(h,d)=>`${r}${s}${f(h,d)}px ${i.map(g=>g.face).join(", ")}`}if(n[0]==="step"){let o=ge(n);return(f,h)=>`${r}${s}${o(f,h)}px ${i.map(d=>d.face).join(", ")}`}return console.log("Can't parse font: ",e),o=>"12px sans-serif"}function pi(e,t){let i=[],n=[],s=new Map;for(let r of e.layers){if(s.set(r.id,r),r.layout&&r.layout.visibility==="none"||r.type==="background")continue;if(r.ref){let d=s.get(r.ref);r.type=d.type,r.filter=d.filter,r.source=d.source,r["source-layer"]=d["source-layer"]}let o=r["source-layer"],f,h;r.filter&&(h=ae(r.filter)),r.type==="fill"?i.push({dataLayer:r["source-layer"],filter:h,symbolizer:new Z({fill:r.paint["fill-color"],opacity:U(r.paint["fill-opacity"],1)})}):r.type==="fill-extrusion"?i.push({dataLayer:r["source-layer"],filter:h,symbolizer:new Z({fill:r.paint["fill-extrusion-color"],opacity:U(r.paint["fill-extrusion-opacity"],1)})}):r.type==="line"?r.paint["line-dasharray"]?i.push({dataLayer:r["source-layer"],filter:h,symbolizer:new G({width:Te(r.paint["line-width"],r.paint["line-gap-width"]),dash:r.paint["line-dasharray"],dashColor:r.paint["line-color"],opacity:U(r.paint["line-opacity"],1)})}):i.push({dataLayer:r["source-layer"],filter:h,symbolizer:new G({color:r.paint["line-color"],opacity:U(r.paint["line-opacity"],1),width:Te(r.paint["line-width"],r.paint["line-gap-width"])})}):r.type==="symbol"?r.layout["symbol-placement"]==="line"?n.push({dataLayer:r["source-layer"],filter:h,symbolizer:new oe({font:Se(r.layout,t),fill:r.paint["text-color"],width:r.paint["text-halo-width"],stroke:r.paint["text-halo-color"],textTransform:r.layout["text-transform"],label_props:r.layout["text-field"]?[r.layout["text-field"]]:void 0})}):n.push({dataLayer:r["source-layer"],filter:h,symbolizer:new se({font:Se(r.layout,t),fill:r.paint["text-color"],stroke:r.paint["text-halo-color"],width:r.paint["text-halo-width"],textTransform:r.layout["text-transform"],label_props:r.layout["text-field"]?[r.layout["text-field"]]:void 0})}):r.type==="circle"&&i.push({dataLayer:r["source-layer"],filter:h,symbolizer:new re({radius:r.paint["circle-radius"],fill:r.paint["circle-color"],stroke:r.paint["circle-stroke-color"],width:r.paint["circle-stroke-width"],opacity:U(r.paint["circle-opacity"],1)})})}return n.reverse(),{paint_rules:i,label_rules:n,paintRules:i,labelRules:n,tasks:[]}}return at(yi);})();
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
