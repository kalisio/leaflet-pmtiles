var pmtiles=(()=>{var it=Object.create;var ce=Object.defineProperty;var rt=Object.getOwnPropertyDescriptor;var nt=Object.getOwnPropertyNames;var st=Object.getPrototypeOf,ot=Object.prototype.hasOwnProperty;var R=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),at=(e,t)=>{for(var i in t)ce(e,i,{get:t[i],enumerable:!0})},Se=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of nt(t))!ot.call(e,s)&&s!==i&&ce(e,s,{get:()=>t[s],enumerable:!(r=rt(t,s))||r.enumerable});return e};var P=(e,t,i)=>(i=e!=null?it(st(e)):{},Se(t||!e||!e.__esModule?ce(i,"default",{value:e,enumerable:!0}):i,e)),lt=e=>Se(ce({},"__esModule",{value:!0}),e);var V=R((bi,Xe)=>{"use strict";Xe.exports=N;function N(e,t){this.x=e,this.y=t}N.prototype={clone:function(){return new N(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,i=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=i,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),r=t*this.x-i*this.y,s=i*this.x+t*this.y;return this.x=r,this.y=s,this},_rotateAround:function(e,t){var i=Math.cos(e),r=Math.sin(e),s=t.x+i*(this.x-t.x)-r*(this.y-t.y),n=t.y+r*(this.x-t.x)+i*(this.y-t.y);return this.x=s,this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};N.convert=function(e){return e instanceof N?e:Array.isArray(e)?new N(e[0],e[1]):e}});var _e=R((Mi,Ve)=>{"use strict";var ht=V();Ve.exports=W;function W(e,t,i,r,s){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=s,e.readFields(ut,this,t)}function ut(e,t,i){e==1?t.id=i.readVarint():e==2?dt(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function dt(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var r=t._keys[e.readVarint()],s=t._values[e.readVarint()];t.properties[r]=s}}W.types=["Unknown","Point","LineString","Polygon"];W.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,r=0,s=0,n=0,o=[],f;e.pos<t;){if(r<=0){var h=e.readVarint();i=h&7,r=h>>3}if(r--,i===1||i===2)s+=e.readSVarint(),n+=e.readSVarint(),i===1&&(f&&o.push(f),f=[]),f.push(new ht(s,n));else if(i===7)f&&f.push(f[0].clone());else throw new Error("unknown command "+i)}return f&&o.push(f),o};W.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,r=0,s=0,n=0,o=1/0,f=-1/0,h=1/0,p=-1/0;e.pos<t;){if(r<=0){var d=e.readVarint();i=d&7,r=d>>3}if(r--,i===1||i===2)s+=e.readSVarint(),n+=e.readSVarint(),s<o&&(o=s),s>f&&(f=s),n<h&&(h=n),n>p&&(p=n);else if(i!==7)throw new Error("unknown command "+i)}return[o,h,f,p]};W.prototype.toGeoJSON=function(e,t,i){var r=this.extent*Math.pow(2,i),s=this.extent*e,n=this.extent*t,o=this.loadGeometry(),f=W.types[this.type],h,p;function d(M){for(var D=0;D<M.length;D++){var T=M[D],a=180-(T.y+n)*360/r;M[D]=[(T.x+s)*360/r-180,360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90]}}switch(this.type){case 1:var w=[];for(h=0;h<o.length;h++)w[h]=o[h][0];o=w,d(o);break;case 2:for(h=0;h<o.length;h++)d(o[h]);break;case 3:for(o=pt(o),h=0;h<o.length;h++)for(p=0;p<o[h].length;p++)d(o[h][p]);break}o.length===1?o=o[0]:f="Multi"+f;var z={type:"Feature",geometry:{type:f,coordinates:o},properties:this.properties};return"id"in this&&(z.id=this.id),z};function pt(e){var t=e.length;if(t<=1)return[e];for(var i=[],r,s,n=0;n<t;n++){var o=mt(e[n]);o!==0&&(s===void 0&&(s=o<0),s===o<0?(r&&i.push(r),r=[e[n]]):r.push(e[n]))}return r&&i.push(r),i}function mt(e){for(var t=0,i=0,r=e.length,s=r-1,n,o;i<r;s=i++)n=e[i],o=e[s],t+=(o.x-n.x)*(n.y+o.y);return t}});var ve=R((Fi,Ie)=>{"use strict";var yt=_e();Ie.exports=Ae;function Ae(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(gt,this,t),this.length=this._features.length}function gt(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(xt(i))}function xt(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var r=e.readVarint()>>3;t=r===1?e.readString():r===2?e.readFloat():r===3?e.readDouble():r===4?e.readVarint64():r===5?e.readVarint():r===6?e.readSVarint():r===7?e.readBoolean():null}return t}Ae.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new yt(this._pbf,t,this.extent,this._keys,this._values)}});var Ue=R((Li,Re)=>{"use strict";var wt=ve();Re.exports=bt;function bt(e,t){this.layers=e.readFields(_t,{},t)}function _t(e,t,i){if(e===3){var r=new wt(i,i.readVarint()+i.pos);r.length&&(t[r.name]=r)}}});var Ee=R((Di,he)=>{he.exports.VectorTile=Ue();he.exports.VectorTileFeature=_e();he.exports.VectorTileLayer=ve()});var je=R(ke=>{ke.read=function(e,t,i,r,s){var n,o,f=s*8-r-1,h=(1<<f)-1,p=h>>1,d=-7,w=i?s-1:0,z=i?-1:1,M=e[t+w];for(w+=z,n=M&(1<<-d)-1,M>>=-d,d+=f;d>0;n=n*256+e[t+w],w+=z,d-=8);for(o=n&(1<<-d)-1,n>>=-d,d+=r;d>0;o=o*256+e[t+w],w+=z,d-=8);if(n===0)n=1-p;else{if(n===h)return o?NaN:(M?-1:1)*(1/0);o=o+Math.pow(2,r),n=n-p}return(M?-1:1)*o*Math.pow(2,n-r)};ke.write=function(e,t,i,r,s,n){var o,f,h,p=n*8-s-1,d=(1<<p)-1,w=d>>1,z=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=r?0:n-1,D=r?1:-1,T=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(f=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-o))<1&&(o--,h*=2),o+w>=1?t+=z/h:t+=z*Math.pow(2,1-w),t*h>=2&&(o++,h/=2),o+w>=d?(f=0,o=d):o+w>=1?(f=(t*h-1)*Math.pow(2,s),o=o+w):(f=t*Math.pow(2,w-1)*Math.pow(2,s),o=0));s>=8;e[i+M]=f&255,M+=D,f/=256,s-=8);for(o=o<<s|f,p+=s;p>0;e[i+M]=o&255,M+=D,o/=256,p-=8);e[i+M-D]|=T*128}});var Ke=R((Ci,He)=>{"use strict";He.exports=v;var ue=je();function v(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}v.Varint=0;v.Fixed64=1;v.Bytes=2;v.Fixed32=5;var ze=(1<<16)*(1<<16),$e=1/ze,vt=12,We=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");v.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),s=r>>3,n=this.pos;this.type=r&7,e(s,t,this),this.pos===n&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=de(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Ne(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=de(this.buf,this.pos)+de(this.buf,this.pos+4)*ze;return this.pos+=8,e},readSFixed64:function(){var e=de(this.buf,this.pos)+Ne(this.buf,this.pos+4)*ze;return this.pos+=8,e},readFloat:function(){var e=ue.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ue.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,i,r;return r=t[this.pos++],i=r&127,r<128||(r=t[this.pos++],i|=(r&127)<<7,r<128)||(r=t[this.pos++],i|=(r&127)<<14,r<128)||(r=t[this.pos++],i|=(r&127)<<21,r<128)?i:(r=t[this.pos],i|=(r&15)<<28,kt(i,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=vt&&We?At(this.buf,t,e):Vt(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==v.Bytes)return e.push(this.readVarint(t));var i=A(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==v.Bytes)return e.push(this.readSVarint());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==v.Bytes)return e.push(this.readBoolean());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==v.Bytes)return e.push(this.readFloat());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==v.Bytes)return e.push(this.readDouble());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==v.Bytes)return e.push(this.readFixed32());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==v.Bytes)return e.push(this.readSFixed32());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==v.Bytes)return e.push(this.readFixed64());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==v.Bytes)return e.push(this.readSFixed64());var t=A(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===v.Varint)for(;this.buf[this.pos++]>127;);else if(t===v.Bytes)this.pos=this.readVarint()+this.pos;else if(t===v.Fixed32)this.pos+=4;else if(t===v.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),K(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),K(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),K(this.buf,e&-1,this.pos),K(this.buf,Math.floor(e*$e),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),K(this.buf,e&-1,this.pos),K(this.buf,Math.floor(e*$e),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){zt(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=It(this.buf,e,this.pos);var i=this.pos-t;i>=128&&Oe(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),ue.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ue.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var r=this.pos-i;r>=128&&Oe(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,i){this.writeTag(e,v.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Lt,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Dt,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Bt,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Tt,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Ct,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,St,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Xt,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Yt,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Pt,t)},writeBytesField:function(e,t){this.writeTag(e,v.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,v.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,v.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,v.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,v.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,v.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,v.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,v.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,v.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,v.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function kt(e,t,i){var r=i.buf,s,n;if(n=r[i.pos++],s=(n&112)>>4,n<128||(n=r[i.pos++],s|=(n&127)<<3,n<128)||(n=r[i.pos++],s|=(n&127)<<10,n<128)||(n=r[i.pos++],s|=(n&127)<<17,n<128)||(n=r[i.pos++],s|=(n&127)<<24,n<128)||(n=r[i.pos++],s|=(n&1)<<31,n<128))return H(e,s,t);throw new Error("Expected varint not more than 10 bytes")}function A(e){return e.type===v.Bytes?e.readVarint()+e.pos:e.pos+1}function H(e,t,i){return i?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function zt(e,t){var i,r;if(e>=0?(i=e%4294967296|0,r=e/4294967296|0):(i=~(-e%4294967296),r=~(-e/4294967296),i^4294967295?i=i+1|0:(i=0,r=r+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),Mt(i,r,t),Ft(r,t)}function Mt(e,t,i){i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos]=e&127}function Ft(e,t){var i=(e&7)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function Oe(e,t,i){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));i.realloc(r);for(var s=i.pos-1;s>=e;s--)i.buf[s+r]=i.buf[s]}function Lt(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function Dt(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function Tt(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function Ct(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function Bt(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function St(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function Xt(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function Yt(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function Pt(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function de(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function K(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function Ne(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Vt(e,t,i){for(var r="",s=t;s<i;){var n=e[s],o=null,f=n>239?4:n>223?3:n>191?2:1;if(s+f>i)break;var h,p,d;f===1?n<128&&(o=n):f===2?(h=e[s+1],(h&192)===128&&(o=(n&31)<<6|h&63,o<=127&&(o=null))):f===3?(h=e[s+1],p=e[s+2],(h&192)===128&&(p&192)===128&&(o=(n&15)<<12|(h&63)<<6|p&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):f===4&&(h=e[s+1],p=e[s+2],d=e[s+3],(h&192)===128&&(p&192)===128&&(d&192)===128&&(o=(n&15)<<18|(h&63)<<12|(p&63)<<6|d&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,f=1):o>65535&&(o-=65536,r+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),r+=String.fromCharCode(o),s+=f}return r}function At(e,t,i){return We.decode(e.subarray(t,i))}function It(e,t,i){for(var r=0,s,n;r<t.length;r++){if(s=t.charCodeAt(r),s>55295&&s<57344)if(n)if(s<56320){e[i++]=239,e[i++]=191,e[i++]=189,n=s;continue}else s=n-55296<<10|s-56320|65536,n=null;else{s>56319||r+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):n=s;continue}else n&&(e[i++]=239,e[i++]=191,e[i++]=189,n=null);s<128?e[i++]=s:(s<2048?e[i++]=s>>6|192:(s<65536?e[i++]=s>>12|224:(e[i++]=s>>18|240,e[i++]=s>>12&63|128),e[i++]=s>>6&63|128),e[i++]=s&63|128)}return i}});var et=R((De,Te)=>{(function(e,t){typeof De=="object"&&typeof Te!="undefined"?Te.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self).RBush=t()})(De,function(){"use strict";function e(a,l,c,m,y){(function u(g,x,b,_,C){for(;_>b;){if(_-b>600){var F=_-b+1,S=x-b+1,J=Math.log(F),E=.5*Math.exp(2*J/3),$=.5*Math.sqrt(J*E*(F-E)/F)*(S-F/2<0?-1:1),O=Math.max(b,Math.floor(x-S*E/F+$)),tt=Math.min(_,Math.floor(x+(F-S)*E/F+$));u(g,x,O,tt,C)}var le=g[x],Q=b,Y=_;for(t(g,b,x),C(g[_],le)>0&&t(g,b,_);Q<Y;){for(t(g,Q,Y),Q++,Y--;C(g[Q],le)<0;)Q++;for(;C(g[Y],le)>0;)Y--}C(g[b],le)===0?t(g,b,Y):t(g,++Y,_),Y<=x&&(b=Y+1),x<=Y&&(_=Y-1)}})(a,l,c||0,m||a.length-1,y||i)}function t(a,l,c){var m=a[l];a[l]=a[c],a[c]=m}function i(a,l){return a<l?-1:a>l?1:0}var r=function(a){a===void 0&&(a=9),this._maxEntries=Math.max(4,a),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function s(a,l,c){if(!c)return l.indexOf(a);for(var m=0;m<l.length;m++)if(c(a,l[m]))return m;return-1}function n(a,l){o(a,0,a.children.length,l,a)}function o(a,l,c,m,y){y||(y=D(null)),y.minX=1/0,y.minY=1/0,y.maxX=-1/0,y.maxY=-1/0;for(var u=l;u<c;u++){var g=a.children[u];f(y,a.leaf?m(g):g)}return y}function f(a,l){return a.minX=Math.min(a.minX,l.minX),a.minY=Math.min(a.minY,l.minY),a.maxX=Math.max(a.maxX,l.maxX),a.maxY=Math.max(a.maxY,l.maxY),a}function h(a,l){return a.minX-l.minX}function p(a,l){return a.minY-l.minY}function d(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function w(a){return a.maxX-a.minX+(a.maxY-a.minY)}function z(a,l){return a.minX<=l.minX&&a.minY<=l.minY&&l.maxX<=a.maxX&&l.maxY<=a.maxY}function M(a,l){return l.minX<=a.maxX&&l.minY<=a.maxY&&l.maxX>=a.minX&&l.maxY>=a.minY}function D(a){return{children:a,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(a,l,c,m,y){for(var u=[l,c];u.length;)if(!((c=u.pop())-(l=u.pop())<=m)){var g=l+Math.ceil((c-l)/m/2)*m;e(a,g,l,c,y),u.push(l,g,g,c)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(a){var l=this.data,c=[];if(!M(a,l))return c;for(var m=this.toBBox,y=[];l;){for(var u=0;u<l.children.length;u++){var g=l.children[u],x=l.leaf?m(g):g;M(a,x)&&(l.leaf?c.push(g):z(a,x)?this._all(g,c):y.push(g))}l=y.pop()}return c},r.prototype.collides=function(a){var l=this.data;if(!M(a,l))return!1;for(var c=[];l;){for(var m=0;m<l.children.length;m++){var y=l.children[m],u=l.leaf?this.toBBox(y):y;if(M(a,u)){if(l.leaf||z(a,u))return!0;c.push(y)}}l=c.pop()}return!1},r.prototype.load=function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var l=0;l<a.length;l++)this.insert(a[l]);return this}var c=this._build(a.slice(),0,a.length-1,0);if(this.data.children.length)if(this.data.height===c.height)this._splitRoot(this.data,c);else{if(this.data.height<c.height){var m=this.data;this.data=c,c=m}this._insert(c,this.data.height-c.height-1,!0)}else this.data=c;return this},r.prototype.insert=function(a){return a&&this._insert(a,this.data.height-1),this},r.prototype.clear=function(){return this.data=D([]),this},r.prototype.remove=function(a,l){if(!a)return this;for(var c,m,y,u=this.data,g=this.toBBox(a),x=[],b=[];u||x.length;){if(u||(u=x.pop(),m=x[x.length-1],c=b.pop(),y=!0),u.leaf){var _=s(a,u.children,l);if(_!==-1)return u.children.splice(_,1),x.push(u),this._condense(x),this}y||u.leaf||!z(u,g)?m?(c++,u=m.children[c],y=!1):u=null:(x.push(u),b.push(c),c=0,m=u,u=u.children[0])}return this},r.prototype.toBBox=function(a){return a},r.prototype.compareMinX=function(a,l){return a.minX-l.minX},r.prototype.compareMinY=function(a,l){return a.minY-l.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(a){return this.data=a,this},r.prototype._all=function(a,l){for(var c=[];a;)a.leaf?l.push.apply(l,a.children):c.push.apply(c,a.children),a=c.pop();return l},r.prototype._build=function(a,l,c,m){var y,u=c-l+1,g=this._maxEntries;if(u<=g)return n(y=D(a.slice(l,c+1)),this.toBBox),y;m||(m=Math.ceil(Math.log(u)/Math.log(g)),g=Math.ceil(u/Math.pow(g,m-1))),(y=D([])).leaf=!1,y.height=m;var x=Math.ceil(u/g),b=x*Math.ceil(Math.sqrt(g));T(a,l,c,b,this.compareMinX);for(var _=l;_<=c;_+=b){var C=Math.min(_+b-1,c);T(a,_,C,x,this.compareMinY);for(var F=_;F<=C;F+=x){var S=Math.min(F+x-1,C);y.children.push(this._build(a,F,S,m-1))}}return n(y,this.toBBox),y},r.prototype._chooseSubtree=function(a,l,c,m){for(;m.push(l),!l.leaf&&m.length-1!==c;){for(var y=1/0,u=1/0,g=void 0,x=0;x<l.children.length;x++){var b=l.children[x],_=d(b),C=(F=a,S=b,(Math.max(S.maxX,F.maxX)-Math.min(S.minX,F.minX))*(Math.max(S.maxY,F.maxY)-Math.min(S.minY,F.minY))-_);C<u?(u=C,y=_<y?_:y,g=b):C===u&&_<y&&(y=_,g=b)}l=g||l.children[0]}var F,S;return l},r.prototype._insert=function(a,l,c){var m=c?a:this.toBBox(a),y=[],u=this._chooseSubtree(m,this.data,l,y);for(u.children.push(a),f(u,m);l>=0&&y[l].children.length>this._maxEntries;)this._split(y,l),l--;this._adjustParentBBoxes(m,y,l)},r.prototype._split=function(a,l){var c=a[l],m=c.children.length,y=this._minEntries;this._chooseSplitAxis(c,y,m);var u=this._chooseSplitIndex(c,y,m),g=D(c.children.splice(u,c.children.length-u));g.height=c.height,g.leaf=c.leaf,n(c,this.toBBox),n(g,this.toBBox),l?a[l-1].children.push(g):this._splitRoot(c,g)},r.prototype._splitRoot=function(a,l){this.data=D([a,l]),this.data.height=a.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(a,l,c){for(var m,y,u,g,x,b,_,C=1/0,F=1/0,S=l;S<=c-l;S++){var J=o(a,0,S,this.toBBox),E=o(a,S,c,this.toBBox),$=(y=J,u=E,g=void 0,x=void 0,b=void 0,_=void 0,g=Math.max(y.minX,u.minX),x=Math.max(y.minY,u.minY),b=Math.min(y.maxX,u.maxX),_=Math.min(y.maxY,u.maxY),Math.max(0,b-g)*Math.max(0,_-x)),O=d(J)+d(E);$<C?(C=$,m=S,F=O<F?O:F):$===C&&O<F&&(F=O,m=S)}return m||c-l},r.prototype._chooseSplitAxis=function(a,l,c){var m=a.leaf?this.compareMinX:h,y=a.leaf?this.compareMinY:p;this._allDistMargin(a,l,c,m)<this._allDistMargin(a,l,c,y)&&a.children.sort(m)},r.prototype._allDistMargin=function(a,l,c,m){a.children.sort(m);for(var y=this.toBBox,u=o(a,0,l,y),g=o(a,c-l,c,y),x=w(u)+w(g),b=l;b<c-l;b++){var _=a.children[b];f(u,a.leaf?y(_):_),x+=w(u)}for(var C=c-l-1;C>=l;C--){var F=a.children[C];f(g,a.leaf?y(F):F),x+=w(g)}return x},r.prototype._adjustParentBBoxes=function(a,l,c){for(var m=c;m>=0;m--)f(l[m],a)},r.prototype._condense=function(a){for(var l=a.length-1,c=void 0;l>=0;l--)a[l].children.length===0?l>0?(c=a[l-1].children).splice(c.indexOf(a[l]),1):this.clear():n(a[l],this.toBBox)},r})});var gi={};at(gi,{filterFn:()=>ae,getFont:()=>Be,getGeometryType:()=>xe,leaflet_style:()=>yi,mapbox_style:()=>mi,numberFn:()=>ge,numberOrFn:()=>U,widthFn:()=>Ce});function xe(e){return e.geomType===1?"Point":e.geomType===2?"LineString":"Polygon"}var ui=P(V(),1);var re=P(V(),1);var X=class{constructor(t,i){this.str=t!=null?t:i,this.perFeature=typeof this.str=="function"&&this.str.length===2}get(t,i){return typeof this.str=="function"?this.str(t,i):this.str}},B=class{constructor(t,i=1){this.value=t!=null?t:i,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(t,i){return typeof this.value=="function"?this.value(t,i):this.value}},ee=class{constructor(t){var i;this.labelProps=(i=t==null?void 0:t.labelProps)!==null&&i!==void 0?i:["name"],this.textTransform=t==null?void 0:t.textTransform}get(t,i){let r,s;typeof this.labelProps=="function"?s=this.labelProps(t,i):s=this.labelProps;for(let o of s)if(Object.prototype.hasOwnProperty.call(i.props,o)&&typeof i.props[o]=="string"){r=i.props[o];break}let n;return typeof this.textTransform=="function"?n=this.textTransform(t,i):n=this.textTransform,r&&n==="uppercase"?r=r.toUpperCase():r&&n==="lowercase"?r=r.toLowerCase():r&&n==="capitalize"&&(r=r.toLowerCase().split(" ").map(h=>h[0].toUpperCase()+h.slice(1)).join(" ")),r}},te=class{constructor(t){var i,r;t!=null&&t.font?this.font=t.font:(this.family=(i=t==null?void 0:t.fontFamily)!==null&&i!==void 0?i:"sans-serif",this.size=(r=t==null?void 0:t.fontSize)!==null&&r!==void 0?r:12,this.weight=t==null?void 0:t.fontWeight,this.style=t==null?void 0:t.fontStyle)}get(t,i){if(this.font)return typeof this.font=="function"?this.font(t,i):this.font;let r="";this.style&&(typeof this.style=="function"?r=`${this.style(t,i)} `:r=`${this.style} `);let s="";this.weight&&(typeof this.weight=="function"?s=`${this.weight(t,i)} `:s=`${this.weight} `);let n;typeof this.size=="function"?n=this.size(t,i):n=this.size;let o;return typeof this.family=="function"?o=this.family(t,i):o=this.family,`${r}${s}${n}px ${o}`}},fe=class{constructor(t,i=[]){this.value=t!=null?t:i,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(t,i){return typeof this.value=="function"?this.value(t,i):this.value}};var we=P(V(),1),ct=(e,t,i)=>{let r=[],s,n,o,f=0,h=0,p=0,d=0,w=0,z=0,M=0,D=0,T=0,a=0,l=0,c=0;if(e.length<2)return[];if(e.length===2)return p=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),[{length:p,beginIndex:0,beginDistance:0,endIndex:2,endDistance:p}];for(d=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),f=1,h=e.length-1;f<h;f++)s=e[f-1],n=e[f],o=e[f+1],z=n.x-s.x,M=n.y-s.y,D=o.x-n.x,T=o.y-n.y,w=Math.sqrt(D*D+T*T),p+=d,a=Math.acos((z*D+M*T)/(d*w)),(a>t||p-c>i)&&(r.push({length:p-c,beginDistance:c,beginIndex:l,endIndex:f+1,endDistance:p}),l=f,c=p),d=w;return f-l>0&&r.push({length:p-c+w,beginIndex:l,beginDistance:c,endIndex:f+1,endDistance:p+w}),r};function Ye(e,t,i,r){let s=[];for(let n of e){let o=ct(n,Math.PI/45,t);for(let f of o)if(f.length>=t+r){let h=new we.default(n[f.beginIndex].x,n[f.beginIndex].y),p=n[f.endIndex-1],d=new we.default((p.x-h.x)/f.length,(p.y-h.y)/f.length);for(let w=r;w<f.length-t;w+=i)s.push({start:h.add(d.mult(w)),end:h.add(d.mult(w+t))})}}return s}function Pe(e,t,i,r){let s=t.x-e.x,n=t.y-e.y,o=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),f=[];for(let h=0;h<i+r;h+=2*r){let p=h*1/o;f.push({x:e.x+p*s,y:e.y+p*n})}return f}function be(e,t){if(e.length<=t)return[e];let i=t-1,r=e.lastIndexOf(" ",i),s=e.indexOf(" ",i);if(r===-1&&s===-1)return[e];let n,o;return s===-1||r>=0&&i-r<s-i?(n=e.substring(0,r),o=e.substring(r+1,e.length)):(n=e.substring(0,s),o=e.substring(s+1,e.length)),[n,...be(o,t)]}var ft="\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DB5\u4E00-\u9FEA\uF900-\uFA6D\uFA70-\uFAD9\u2000",ki=new RegExp(`^[${ft}]+$`);var qt=P(V(),1),Zt=P(Ee(),1),Gt=P(Ke(),1);var q=Uint8Array,qe=Uint16Array,Rt=Int32Array,Ut=new q([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Et=new q([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Bi=new q([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ze=function(e,t){for(var i=new qe(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];for(var s=new Rt(i[30]),r=1;r<30;++r)for(var n=i[r];n<i[r+1];++n)s[n]=n-i[r]<<5|r;return{b:i,r:s}},Ge=Ze(Ut,2),jt=Ge.b,$t=Ge.r;jt[28]=258,$t[258]=28;var Je=Ze(Et,0),Si=Je.b,Xi=Je.r,Ot=new qe(32768);for(k=0;k<32768;++k)I=(k&43690)>>1|(k&21845)<<1,I=(I&52428)>>2|(I&13107)<<2,I=(I&61680)>>4|(I&3855)<<4,Ot[k]=((I&65280)>>8|(I&255)<<8)>>1;var I,k;var pe=new q(288);for(k=0;k<144;++k)pe[k]=8;var k;for(k=144;k<256;++k)pe[k]=9;var k;for(k=256;k<280;++k)pe[k]=7;var k;for(k=280;k<288;++k)pe[k]=8;var k,Nt=new q(32);for(k=0;k<32;++k)Nt[k]=5;var k;var Wt=new q(0);var Ht=typeof TextDecoder!="undefined"&&new TextDecoder,Kt=0;try{Ht.decode(Wt,{stream:!0}),Kt=1}catch(e){}var Me;(function(e){e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.Polygon=3]="Polygon"})(Me||(Me={}));var Jt=6378137;var Ai=Jt*Math.PI;var j;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(j||(j={}));var Qe;(function(e){e[e.N=1]="N",e[e.Ne=2]="Ne",e[e.E=3]="E",e[e.Se=4]="Se",e[e.S=5]="S",e[e.Sw=6]="Sw",e[e.W=7]="W",e[e.Nw=8]="Nw"})(Qe||(Qe={}));var Z=class{constructor(t){var i;this.pattern=t.pattern,this.fill=new X(t.fill,"black"),this.opacity=new B(t.opacity,1),this.stroke=new X(t.stroke,"black"),this.width=new B(t.width,0),this.perFeature=(i=this.fill.perFeature||this.opacity.perFeature||this.stroke.perFeature||this.width.perFeature||t.perFeature)!==null&&i!==void 0?i:!1,this.doStroke=!1}before(t,i){if(!this.perFeature){t.globalAlpha=this.opacity.get(i),t.fillStyle=this.fill.get(i),t.strokeStyle=this.stroke.get(i);let r=this.width.get(i);r>0&&(this.doStroke=!0),t.lineWidth=r}if(this.pattern){let r=t.createPattern(this.pattern,"repeat");r&&(t.fillStyle=r)}}draw(t,i,r,s){let n=!1;if(this.perFeature){t.globalAlpha=this.opacity.get(r,s),t.fillStyle=this.fill.get(r,s);let f=this.width.get(r,s);f&&(n=!0,t.strokeStyle=this.stroke.get(r,s),t.lineWidth=f)}let o=()=>{t.fill(),(n||this.doStroke)&&t.stroke()};t.beginPath();for(let f of i)for(let h=0;h<f.length;h++){let p=f[h];h===0?t.moveTo(p.x,p.y):t.lineTo(p.x,p.y)}o()}};function Qt(e,t){let i=0;for(;t[i+1][0]<e;)i++;return i}function ei(e,t,i){return e*(i-t)+t}function ti(e,t,i,r){let s=r[t+1][0]-r[t][0],n=e-r[t][0];return s===0?0:i===1?n/s:(Math.pow(i,n)-1)/(Math.pow(i,s)-1)}function me(e,t){return i=>{if(t.length<1)return 0;if(i<=t[0][0])return t[0][1];if(i>=t[t.length-1][0])return t[t.length-1][1];let r=Qt(i,t),s=ti(i,r,e,t);return ei(s,t[r][1],t[r+1][1])}}var G=class{constructor(t){var i;this.color=new X(t.color,"black"),this.width=new B(t.width),this.opacity=new B(t.opacity),this.dash=t.dash?new fe(t.dash):null,this.dashColor=new X(t.dashColor,"black"),this.dashWidth=new B(t.dashWidth,1),this.lineCap=new X(t.lineCap,"butt"),this.lineJoin=new X(t.lineJoin,"miter"),this.skip=!1,this.perFeature=!!(((i=this.dash)===null||i===void 0?void 0:i.perFeature)||this.color.perFeature||this.opacity.perFeature||this.width.perFeature||this.lineCap.perFeature||this.lineJoin.perFeature||t.perFeature)}before(t,i){this.perFeature||(t.strokeStyle=this.color.get(i),t.lineWidth=this.width.get(i),t.globalAlpha=this.opacity.get(i),t.lineCap=this.lineCap.get(i),t.lineJoin=this.lineJoin.get(i))}draw(t,i,r,s){if(this.skip)return;let n=()=>{this.perFeature&&(t.globalAlpha=this.opacity.get(r,s),t.lineCap=this.lineCap.get(r,s),t.lineJoin=this.lineJoin.get(r,s)),this.dash?(t.save(),this.perFeature?(t.lineWidth=this.dashWidth.get(r,s),t.strokeStyle=this.dashColor.get(r,s),t.setLineDash(this.dash.get(r,s))):t.setLineDash(this.dash.get(r)),t.stroke(),t.restore()):(t.save(),this.perFeature&&(t.lineWidth=this.width.get(r,s),t.strokeStyle=this.color.get(r,s)),t.stroke(),t.restore())};t.beginPath();for(let o of i)for(let f=0;f<o.length;f++){let h=o[f];f===0?t.moveTo(h.x,h.y):t.lineTo(h.x,h.y)}n()}};var ne=class{constructor(t){this.radius=new B(t.radius,3),this.fill=new X(t.fill,"black"),this.stroke=new X(t.stroke,"white"),this.width=new B(t.width,0),this.opacity=new B(t.opacity)}draw(t,i,r,s){t.globalAlpha=this.opacity.get(r,s);let n=this.radius.get(r,s),o=this.width.get(r,s);o>0&&(t.strokeStyle=this.stroke.get(r,s),t.lineWidth=o,t.beginPath(),t.arc(i[0][0].x,i[0][0].y,n+o/2,0,2*Math.PI),t.stroke()),t.fillStyle=this.fill.get(r,s),t.beginPath(),t.arc(i[0][0].x,i[0][0].y,n,0,2*Math.PI),t.fill()}place(t,i,r){let s=i[0],n=new re.default(i[0][0].x,i[0][0].y),o=this.radius.get(t.zoom,r),f={minX:n.x-o,minY:n.y-o,maxX:n.x+o,maxY:n.y+o};return[{anchor:n,bboxes:[f],draw:p=>{this.draw(p,[[new re.default(0,0)]],t.zoom,r)}}]}};var Fe=class{constructor(t){this.symbolizer=t}place(t,i,r){let s=i[0][0],n=this.symbolizer.place(t,[[new re.default(0,0)]],r);if(!n||n.length===0)return;let o=n[0],f=o.bboxes[0],h=f.maxX-f.minX,p=f.maxY-f.minY,d={minX:s.x-h/2,maxX:s.x+h/2,minY:s.y-p/2,maxY:s.y+p/2};return[{anchor:s,bboxes:[d],draw:z=>{z.translate(-h/2,p/2-f.maxY),o.draw(z,{justify:j.Center})}}]}};var Le=class{constructor(t){this.font=new te(t),this.text=new ee(t),this.fill=new X(t.fill,"black"),this.stroke=new X(t.stroke,"black"),this.width=new B(t.width,0),this.lineHeight=new B(t.lineHeight,1),this.letterSpacing=new B(t.letterSpacing,0),this.maxLineCodeUnits=new B(t.maxLineChars,15),this.justify=t.justify}place(t,i,r){let s=this.text.get(t.zoom,r);if(!s)return;let n=this.font.get(t.zoom,r);t.scratch.font=n;let o=this.letterSpacing.get(t.zoom,r),f=be(s,this.maxLineCodeUnits.get(t.zoom,r)),h="",p=0;for(let c of f)c.length>p&&(p=c.length,h=c);let d=t.scratch.measureText(h),w=d.width+o*(p-1),z=d.actualBoundingBoxAscent,M=d.actualBoundingBoxDescent,D=(z+M)*this.lineHeight.get(t.zoom,r),T=new re.default(i[0][0].x,i[0][0].y),a={minX:T.x,minY:T.y-z,maxX:T.x+w,maxY:T.y+M+(f.length-1)*D};return[{anchor:T,bboxes:[a],draw:(c,m)=>{c.globalAlpha=1,c.font=n,c.fillStyle=this.fill.get(t.zoom,r);let y=this.width.get(t.zoom,r),u=0;for(let g of f){let x=0;if(this.justify===j.Center||m&&m.justify===j.Center?x=(w-c.measureText(g).width)/2:(this.justify===j.Right||m&&m.justify===j.Right)&&(x=w-c.measureText(g).width),y)if(c.lineWidth=y*2,c.strokeStyle=this.stroke.get(t.zoom,r),o>0){let b=x;for(let _ of g)c.strokeText(_,b,u),b+=c.measureText(_).width+o}else c.strokeText(g,x,u);if(o>0){let b=x;for(let _ of g)c.fillText(_,b,u),b+=c.measureText(_).width+o}else c.fillText(g,x,u);u+=D}}}]}},se=class{constructor(t){this.centered=new Fe(new Le(t))}place(t,i,r){return this.centered.place(t,i,r)}};var ie;(function(e){e[e.Above=1]="Above",e[e.Center=2]="Center",e[e.Below=3]="Below"})(ie||(ie={}));var oe=class{constructor(t){var i;this.font=new te(t),this.text=new ee(t),this.fill=new X(t.fill,"black"),this.stroke=new X(t.stroke,"black"),this.width=new B(t.width,0),this.offset=new B(t.offset,0),this.position=(i=t.position)!==null&&i!==void 0?i:ie.Above,this.maxLabelCodeUnits=new B(t.maxLabelChars,40),this.repeatDistance=new B(t.repeatDistance,250)}place(t,i,r){let s=this.text.get(t.zoom,r);if(!s||s.length>this.maxLabelCodeUnits.get(t.zoom,r))return;let n=20,o=r.bbox;if(o.maxY-o.minY<n&&o.maxX-o.minX<n)return;let f=this.font.get(t.zoom,r);t.scratch.font=f;let h=t.scratch.measureText(s),p=h.width,d=h.actualBoundingBoxAscent+h.actualBoundingBoxDescent,w=this.repeatDistance.get(t.zoom,r);t.overzoom>4&&(w*=1<<t.overzoom-4);let z=d*2,M=Ye(i,p,w,z);if(M.length===0)return;let D=[];for(let T of M){let a=T.end.x-T.start.x,l=T.end.y-T.start.y,m=Pe(T.start,T.end,p,z/2).map(u=>({minX:u.x-z/2,minY:u.y-z/2,maxX:u.x+z/2,maxY:u.y+z/2})),y=u=>{u.globalAlpha=1,u.rotate(Math.atan2(l,a)),a<0&&(u.scale(-1,-1),u.translate(-p,0));let g=0;this.position===ie.Below?g+=d:this.position===ie.Center&&(g+=d/2),u.translate(0,g-this.offset.get(t.zoom,r)),u.font=f;let x=this.width.get(t.zoom,r);x&&(u.lineWidth=x,u.strokeStyle=this.stroke.get(t.zoom,r),u.strokeText(s,0,0)),u.fillStyle=this.fill.get(t.zoom,r),u.fillText(s,0,0)};D.push({anchor:T.start,bboxes:m,draw:y,deduplicationKey:s,deduplicationDistance:w})}return D}};var ni=P(V(),1),si=P(et(),1);var ii=P(V(),1);var oi=P(V(),1);var di=6378137;var dr=di*Math.PI;var pi=P(V(),1);function ye(e,t){return typeof e=="number"?e:t}function ae(e){if(e.includes("$type")&&e[0]==="==")return(t,i)=>xe(i)===e[2];if(e[0]==="==")return(t,i)=>i.props[e[1]]===e[2];if(e[0]==="!=")return(t,i)=>i.props[e[1]]!==e[2];if(e[0]==="!"){let t=ae(e[1]);return(i,r)=>!t(i,r)}if(e[0]==="<")return(t,i)=>ye(i.props[e[1]],1/0)<e[2];if(e[0]==="<=")return(t,i)=>ye(i.props[e[1]],1/0)<=e[2];if(e[0]===">")return(t,i)=>ye(i.props[e[1]],-1/0)>e[2];if(e[0]===">=")return(t,i)=>ye(i.props[e[1]],-1/0)>=e[2];if(e[0]==="in")return(t,i)=>e.slice(2,e.length).includes(i.props[e[1]]);if(e[0]==="!in")return(t,i)=>!e.slice(2,e.length).includes(i.props[e[1]]);if(e[0]==="has")return(t,i)=>i.props.hasOwnProperty(e[1]);if(e[0]==="!has")return(t,i)=>!i.props.hasOwnProperty(e[1]);if(e[0]==="all"){let t=e.slice(1,e.length).map(i=>ae(i));return(i,r)=>t.every(s=>s(i,r))}if(e[0]==="any"){let t=e.slice(1,e.length).map(i=>ae(i));return(i,r)=>t.some(s=>s(i,r))}return console.log("Unimplemented filter: ",e[0]),t=>!1}function ge(e){if(e.stops)return t=>me(e.base||1,e.stops)(t-1);if(e[0]==="interpolate"&&e[1][0]==="exponential"&&e[2][0]==="zoom"){let t=e.slice(3),i=[];for(let r=0;r<t.length;r+=2)i.push([t[r],t[r+1]]);return r=>me(e[1][1],i)(r-1)}if(e[0]==="step"&&e[1][0]==="get"){let t=e.slice(2),i=e[1][1];return(r,s)=>{let n=s==null?void 0:s.props[i];if(typeof n=="number"){if(n<t[1])return t[0];for(let o=1;o<t.length;o+=2)if(n<=t[o])return t[o+1]}return t[t.length-1]}}return console.log("Unimplemented numeric fn: ",e),t=>1}function U(e,t=0){return e?typeof e=="number"?e:(i,r)=>r?ge(e)(i,r):t:t}function Ce(e,t){let i=U(e,1),r=U(t);return(s,n)=>{let o=typeof i=="number"?i:i(s,n);return r?o+(typeof r=="number"?r:r(s,n)):o}}function Be(e,t){let i=[];for(let o of e["text-font"])t.hasOwnProperty(o)&&i.push(t[o]);i.length===0&&i.push({face:"sans-serif"});let r=e["text-size"],s="";i.length&&i[0].weight&&(s=`${i[0].weight} `);let n="";if(i.length&&i[0].style&&(n=`${i[0].style} `),typeof r=="number")return o=>`${n}${s}${r}px ${i.map(f=>f.face).join(", ")}`;if(r.stops){let o=1.4;r.base?o=r.base:r.base=o;let f=ge(r);return(h,p)=>`${n}${s}${f(h,p)}px ${i.map(d=>d.face).join(", ")}`}if(r[0]==="step"){let o=ge(r);return(f,h)=>`${n}${s}${o(f,h)}px ${i.map(p=>p.face).join(", ")}`}return console.log("Can't parse font: ",e),o=>"12px sans-serif"}function mi(e,t){let i=[],r=[],s=new Map;for(let n of e.layers){if(s.set(n.id,n),n.layout&&n.layout.visibility==="none"||n.type==="background")continue;if(n.ref){let p=s.get(n.ref);n.type=p.type,n.filter=p.filter,n.source=p.source,n["source-layer"]=p["source-layer"]}let o=n["source-layer"],f,h;n.filter&&(h=ae(n.filter)),n.type==="fill"?i.push({dataLayer:n["source-layer"],filter:h,symbolizer:new Z({fill:n.paint["fill-color"],opacity:U(n.paint["fill-opacity"],1)})}):n.type==="fill-extrusion"?i.push({dataLayer:n["source-layer"],filter:h,symbolizer:new Z({fill:n.paint["fill-extrusion-color"],opacity:U(n.paint["fill-extrusion-opacity"],1)})}):n.type==="line"?n.paint["line-dasharray"]?i.push({dataLayer:n["source-layer"],filter:h,symbolizer:new G({width:Ce(n.paint["line-width"],n.paint["line-gap-width"]),dash:n.paint["line-dasharray"],dashColor:n.paint["line-color"],opacity:U(n.paint["line-opacity"],1)})}):i.push({dataLayer:n["source-layer"],filter:h,symbolizer:new G({color:n.paint["line-color"],opacity:U(n.paint["line-opacity"],1),width:Ce(n.paint["line-width"],n.paint["line-gap-width"])})}):n.type==="symbol"?n.layout["symbol-placement"]==="line"?r.push({dataLayer:n["source-layer"],filter:h,symbolizer:new oe({font:Be(n.layout,t),fill:n.paint["text-color"],width:n.paint["text-halo-width"],stroke:n.paint["text-halo-color"],textTransform:n.layout["text-transform"],label_props:n.layout["text-field"]?[n.layout["text-field"]]:void 0,labelProps:n.layout["text-field"]?[n.layout["text-field"]]:void 0})}):r.push({dataLayer:n["source-layer"],filter:h,symbolizer:new se({font:Be(n.layout,t),fill:n.paint["text-color"],stroke:n.paint["text-halo-color"],width:n.paint["text-halo-width"],textTransform:n.layout["text-transform"],label_props:n.layout["text-field"]?[n.layout["text-field"]]:void 0,labelProps:n.layout["text-field"]?[n.layout["text-field"]]:void 0})}):n.type==="circle"&&i.push({dataLayer:n["source-layer"],filter:h,symbolizer:new ne({radius:n.paint["circle-radius"],fill:n.paint["circle-color"],stroke:n.paint["circle-stroke-color"],width:n.paint["circle-stroke-width"],opacity:U(n.paint["circle-opacity"],1)})})}return r.reverse(),{paint_rules:i,label_rules:r,paintRules:i,labelRules:r,tasks:[]}}function yi(e,t){let i=[];function r(d){return d.stroke==!1?0:d.hasOwnProperty("weight")?d.weight:3}function s(d){return d.hasOwnProperty("color")?d.color:"#3388ff"}function n(d){return d.hasOwnProperty("opacity")?d.opacity:1}function o(d){return d.fill==!1?"transparent":d.hasOwnProperty("fillColor")==!0?d.fillColor:s(d)}function f(d){return d.hasOwnProperty("fillOpacity")?d.fillOpacity:.2}function h(d){return d.hasOwnProperty("lineCap")?d.lineCap:"round"}let p=h;return e.hasOwnProperty("radius")&&i.push({dataLayer:t,filter:(d,w)=>w.geomType==1,symbolizer:new protomapsL.CircleSymbolizer({radius:e.radius,fill:o(e),opacity:n(e),width:r(e),stroke:s(e)})}),i.push({dataLayer:t,symbolizer:new protomapsL.LineSymbolizer({width:r(e),color:s(e),opacity:n(e),lineCap:h(e),lineJoin:p(e),dash:typeof e.dashArray=="string"?e.dashArray.split(" ").map(parseFloat):e.dashArray,dashColor:s(e),dashWidth:r(e)})}),i.push({dataLayer:t,filter:(d,w)=>w.geomType==3,symbolizer:new protomapsL.PolygonSymbolizer({fill:o(e),opacity:f(e)})}),{paint_rules:i,paintRules:i,tasks:[]}}return lt(gi);})();
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
